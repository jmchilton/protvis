<tal:var define="global spec python: urlencode(spectrum)"></tal:var>
<tal:if condition="python: offset == None or int(offset) < 0 or datafile == None">
	<script>
		DetailsDialog.attr("title", "Spectrum Not Found");
		DetailsDialog.attr("content", "The requeted spectrum could not be found.<br/>It is possible that the names got mangled by the tools generating the data");
		DetailsDialog.attr("style", "width: 400px;");
		DetailsDialog.show();
	</script>
</tal:if>
<tal:else condition="python: offset != None and int(offset) >= 0 and datafile != None">
	<tal:if condition="python: pep_datafile != None and pep_query_offset != None and pep_hit_offset != None">
		<iframe src="/lorikeet?file=${file}&n=${datafile}&type=${type}&spectrum=${spec}&off=${offset}&pn=${pep_datafile}&pqoff=${pep_query_offset}&phoff=${pep_hit_offset}" style="width:100%; height:613px; border:0px;"></iframe>
	</tal:if>
	<tal:else condition="python: pep_datafile == None or pep_query_offset == None or pep_hit_offset == None">
		<iframe src="/lorikeet?file=${file}&n=${datafile}&type=${type}&spectrum=${spec}&off=${offset}" style="width:100%; height:578px; border:0px;"></iframe>
	</tal:else>
	<script>SwitchDataset(${datafile}, "data_spectrum");</script>
</tal:else>
